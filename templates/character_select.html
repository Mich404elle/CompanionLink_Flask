<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Select Character | CompanionLink</title>
    <link href="https://fonts.googleapis.com/css2?family=Helvetica+Neue:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-black: #000000;
            --primary-red: #FF0000;
            --background: #FFFFFF;
            --grid-color: #E5E5E5;
            --spacing: 1.5rem;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Helvetica Neue', Arial, sans-serif;
        }

        body {
            background: var(--background);
            min-height: 100vh;
            padding: 2rem;
        }

        .back-button {
            position: absolute;
            top: 2rem;
            left: 2rem;
            padding: 0.75rem 1.5rem;
            background: var(--primary-black);
            color: white;
            text-decoration: none;
            font-weight: 700;
            text-transform: uppercase;
            transition: background 0.2s;
        }

        .back-button:hover {
            background: var(--primary-red);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 2rem;
            text-align: center;
            margin-top: 3rem;
            /* Added margin to account for back button */
        }

        .characters-container {
            display: flex;
            justify-content: center;
            align-items: stretch;
            gap: 2rem;
            margin-top: 2rem;
            flex-wrap: wrap;
        }

        .character-card {
            flex: 0 1 400px;
            border: 2px solid var(--primary-black);
            padding: 2rem;
            text-align: center;
            background: white;
            min-height: 500px;
            display: flex;
            flex-direction: column;
            min-height: 400px
        }

        .character-image {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            margin: 0 auto 1rem;
            background: #eee;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            color: #666;
        }

        .character-name {
            font-size: 1.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            height: 2rem;
        }

        .character-level {
            font-size: 0.875rem;
            text-transform: uppercase;
            color: #666;
            margin-bottom: 1.5rem;
        }

        .character-description {
            font-size: 1rem;
            line-height: 1.5;
            margin-bottom: 1rem;
            flex-grow: 1;
            min-height: 150px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .character-button {
            background: var(--primary-black);
            color: white;
            border: none;
            padding: 0.75rem 0;
            width: 100%;
            font-weight: 700;
            text-transform: uppercase;
            cursor: pointer;
            transition: background 0.2s;
            margin-top: auto;
        }

        .character-button:hover {
            background: var(--primary-red);
        }

        .chat-options {
            display: flex;
            gap: 1rem;
            justify-content: center;
            margin-top: 1rem;
        }

        .character-button {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            min-width: 120px;
        }

        .button-icon {
            flex-shrink: 0;
        }
    </style>
</head>

<body>
    <a href="/" class="back-button">‚Üê Back to Home</a>

    <!-- Melissa Card -->
    <div class="character-card">
        <div class="character-image">üëµ</div>
        <h2 class="character-name">Melissa</h2>
        <div class="character-level">Basic Communication Practice</div>
        <p class="character-description">
            A warm and caring grandmother who loves sharing stories about her life
            and family. Practice basic communication skills and empathy building
            through conversations about daily life and family relationships.
        </p>
        <div class="chat-options">
            <button onclick="window.location.href='/melissa_chat'" class="character-button text-chat">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    class="button-icon">
                    <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z" />
                </svg>
                Text Chat
            </button>
            <button onclick="window.location.href='/melissa_voicechat'" class="character-button voice-chat">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                    class="button-icon">
                    <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z" />
                    <path d="M19 10v2a7 7 0 0 1-14 0v-2" />
                </svg>
                Voice Chat
            </button>
        </div>
    </div>

    <!-- Ian Card -->
    <div class="character-card">
        <div class="character-image">üë®</div>
        <h2 class="character-name">Ian</h2>
        <div class="character-level">Advanced Communication Practice</div>
        <p class="character-description">
            A quiet figure with a guarded past, filled with dark and unspoken memories.
            His story is there, but out of reach for strangers. For those who can earn his trust, he may gradually open
            up and reveal the
            stories he keeps to his heart.
        </p>
        <button onclick="selectCharacter('ian')" class="character-button">Chat with Ian</button>
    </div>
    </div>
    </div>

    <script>
        // Navigation handling
        window.addEventListener('pageshow', function (event) {
            // Force reload if page is coming from cache
            if (event.persisted || (window.performance && window.performance.navigation.type === 2)) {
                window.location.reload();
            }
        });

        // Handle initial page load and transitions
        document.addEventListener('DOMContentLoaded', function () {
            // Initial page load animation
            if (document.body.style.opacity !== '1') {
                document.body.style.opacity = '0';
                requestAnimationFrame(() => {
                    document.body.style.transition = 'opacity 0.3s ease';
                    document.body.style.opacity = '1';
                });
            }

            // Handle internal navigation links
            document.querySelectorAll('a[href^="/"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    const href = this.getAttribute('href');
                    e.preventDefault();
                    document.body.style.opacity = '0';
                    setTimeout(() => {
                        window.location.href = href;
                    }, 200);
                });
            });
        });

        // Cache control
        document.addEventListener('unload', function () {
            window.sessionStorage.setItem('needsReload', 'true');
        });

        if (window.sessionStorage.getItem('needsReload')) {
            window.sessionStorage.removeItem('needsReload');
            window.location.reload();
        }

        // Character selection with transition
        function selectCharacter(character) {
            document.body.style.opacity = '0';
            setTimeout(() => {
                if (character === 'melissa') {
                    window.location.href = '/melissa_chat';
                } else if (character === 'ian') {
                    window.location.href = '/ian_chat';
                }
            }, 200);
        }
    </script>
</body>

</html>